FROM python:3.12-slim
WORKDIR /app
RUN apt-get update && apt-get install -y ffmpeg && rm -rf /var/lib/apt/lists/*
COPY platform/backend/requirements.txt ./requirements.txt
RUN pip install -r requirements.txt
COPY platform/backend /app
ENV OUTPUT_ROOT=/app/data/artifacts \
    SIMULATE_RENDER=1 \
    APP_VERSION=dev GIT_SHA=local
VOLUME ["/app/data"]
CMD ["python","-m","app.worker"]
